<template name="autotable">
  {{#with context}}
    {{>UI.contentBlock reactiveConfig}}
    {{#if pageLimit}}
      <div class="row">
        <div class="col-md-12">
          <div class="pull-right">
            <strong>{{firstVisibleItem}}-{{lastVisibleItem}}</strong> of <strong>{{itemCount}}</strong>
            <div class="btn-group">
              <button type="button" class="btn btn-default" data-action="lastPage" {{lastDisabled}}><span class="glyphicon glyphicon-chevron-left"></span></button>
              <button type="button" class="btn btn-default" data-action="nextPage" {{nextDisabled}}><span class="glyphicon glyphicon-chevron-right"></span></button>
            </div>
          </div>
        </div>
      </div>
    {{/if}}
    <table class="{{class}}">
      <thead>
        <tr>
          {{#each fields}}
            {{#if sortable}}
              <th><span class="autotable-field-heading" data-sort-key="{{key}}">
                  {{label}} &nbsp;
                  {{#if isSortKey}} {{#if isAscending}}
                      <span class="glyphicon glyphicon-chevron-down"></span>
                      {{else}}
                      <span class="glyphicon glyphicon-chevron-up"></span>
                  {{/if}}{{/if}}
              </span></th>
              {{else}}
              <th>{{label}}</th>
            {{/if}}
          {{/each}}
          {{#if actionColumn}}
            <th>Actions</th>
          {{/if}}

        </tr>
      </thead>
      {{#if ready}}
        <tbody>
          {{#each records}}
            <tr class="{{rowClass}}" data-doc="{{_id}}">
              {{#each ../fields}}
                <td>
                  {{#if tpl}}
                    {{#with fieldCellContext ..}}
                      {{> ../tpl}}
                    {{/with}}
                    {{else}}
                    {{getField ..}}
                  {{/if}}
                </td>
              {{/each}}
              {{#if ../actionColumn}}
                <td>
                  <button type="button" class="btn btn-sm btn-primary" data-action="cloneItem" title="Clone"><span class="glyphicon glyphicon-duplicate"></span></button>
                  &nbsp;
                  <button type="button" class="btn btn-sm btn-warning" data-action="editItem" title="Edit"><span class="glyphicon glyphicon-pencil"></span></button>
                  &nbsp;
                  <button type="button" class="btn btn-sm btn-danger" data-action="deleteItem" title="Delete"><span class="glyphicon glyphicon-trash"></span></button>
                </td>
              {{/if}}
            </tr>
          {{/each}}
          {{#if addButton}}
            <tr>
              <td colspan={{fieldCount}}>
                <button class="btn" data-action="insert">Add...</button>

              </td>
            </tr>
          {{/if}}
        </tbody>
        {{else}}
        <td colspan={{fieldCount}}>
          {{> loading}}
        </td>
      {{/if}}
    </table>
  {{/with}}
</template>

